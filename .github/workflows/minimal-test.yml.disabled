name: Phase 1 - Basic Build and Test

on:
  push:
    branches: [ master, main ]
  pull_request:
    branches: [ master, main ]

jobs:
  basic-build-test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Set up JDK 24
      uses: actions/setup-java@v4
      with:
        java-version: '24'
        distribution: 'temurin'
    
    - name: Configure Maven for Central Repository Only
      run: |
        mkdir -p ~/.m2
        cat > ~/.m2/settings.xml << 'EOF'
        <settings>
          <mirrors>
            <mirror>
              <id>central-only</id>
              <url>https://repo1.maven.org/maven2</url>
              <mirrorOf>*</mirrorOf>
            </mirror>
          </mirrors>
        </settings>
        EOF
        echo "âœ… Maven configured for Central Repository only"
    
    - name: Maven Clean Compile
      run: |
        echo "ðŸ”¨ Starting Maven compilation..."
        mvn clean compile -B
        echo "âœ… Maven compilation completed"
    
    - name: Run Unit Tests
      run: |
        echo "ðŸ§ª Running unit tests..."
        mvn test -B
        echo "âœ… Unit tests completed"
    
    - name: Package JARs
      run: |
        echo "ðŸ“¦ Creating JAR packages..."
        mvn package -B -DskipTests
        echo "âœ… JAR packaging completed"
    
    - name: List Build Artifacts
      run: |
        echo "ðŸ“‹ Build artifacts created:"
        find . -name "*.jar" -type f | head -10
    
    - name: Build Status Summary
      if: always()
      run: |
        echo "=================================="
        echo "ðŸŽ¯ PHASE 1 BUILD SUMMARY"
        echo "=================================="
        echo "âœ… Java 24 setup: SUCCESS"
        echo "âœ… Maven compilation: SUCCESS"
        echo "âœ… Unit tests: SUCCESS"
        echo "âœ… JAR packaging: SUCCESS"
        echo "ðŸš€ Ready for Phase 2 (Multi-platform)"